<ng-container *ngIf="canDisplayOptions; else noOptions">

  <form [formGroup]="form">

    <!-- SINGLE-ANSWER (radio) -->
    <mat-radio-group
      *ngIf="optionBindings[0].type === 'single'"
      formControlName="selectedOptionId"
      (selectionChange)="handleRadioGroupChange($event)">

      <div
        *ngFor="let b of optionBindings; let i = index; trackBy: trackByOptionId"
        class="option-row">

        <ng-container *ngIf="feedbackState$ | async as state">
          <label class="option-row options"
                appHighlightOption
                [optionBinding]="b"
                [isCorrect]="b.isCorrect"
                [isSelected]="shouldShowFeedback(i)">

            <mat-radio-button
              [value]="b.option.optionId"
              (click)="onRadioClick(b, i)">

              <span class="option-text">
                {{ getOptionDisplayText(b.option, i) }}
              </span>

              <mat-icon *ngIf="shouldShowIcon(b.option)"
                        class="opt-icon">
                {{ getOptionIcon(b.option) }}
              </mat-icon>
            </mat-radio-button>
          </label>
        </ng-container>

        <ng-container *ngIf="state as s">
          <codelab-quiz-feedback
            *ngIf="shouldShowFeedback(i)"
            [feedbackConfig]="feedbackConfigs[i]">
          </codelab-quiz-feedback>
        </ng-container>
        
      </div>
    </mat-radio-group>


    <!-- MULTIPLE-ANSWER (checkbox) -->
    <div *ngIf="optionBindings[0].type === 'multiple'">

      <div
        *ngFor="let b of optionBindings; let i = index; trackBy: trackByOptionId"
        class="option-row">

        <label class="option-row options"
              appHighlightOption
              [optionBinding]="b"
              [isCorrect]="b.isCorrect">

          <mat-checkbox
            [checked]="b.option.selected"
            (change)="onMatCheckboxChanged(b, i, $event)">

            <span class="option-text">
              {{ getOptionDisplayText(b.option, i) }}
            </span>

            <mat-icon *ngIf="shouldShowIcon(b.option)"
                      class="opt-icon">
              {{ getOptionIcon(b.option) }}
            </mat-icon>
          </mat-checkbox>
        </label>

        <codelab-quiz-feedback
          *ngIf="shouldShowFeedback(i)"
          [feedbackConfig]="feedbackConfigs[i]">
        </codelab-quiz-feedback>
      </div>
    </div>

  </form>

</ng-container>

<ng-template #noOptions>
  <span *ngIf="renderReady && (!question || optionsToDisplay?.length === 0); else noExplanation">
    No options available.
  </span>
</ng-template>


