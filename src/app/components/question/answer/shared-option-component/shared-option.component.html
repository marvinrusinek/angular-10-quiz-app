<ng-container *ngIf="canDisplayOptions; else noOptions">
  <form [formGroup]="form">

    <!-- SINGLE‐ANSWER -->
    <ng-container *ngIf="optionBindings[0]?.type==='single'; else multipleBlock">
      <mat-radio-group
        formControlName="selectedOptionId"
        (selectionChange)="onGroupSelectionChange($event)"
      >
        <div *ngFor="let b of optionBindings; let i = index; trackBy: trackByOption">
          <label class="options">
            <mat-radio-button
              [value]="b.option.optionId"
              (click)="onRadioClick(b, i)"
              appHighlightOption
              [optionBinding]="b"
            >
              {{ getOptionDisplayText(b.option, i) }}
            </mat-radio-button>
            <codelab-quiz-feedback
              *ngIf="shouldShowFeedback(i)"
              [feedbackConfig]="feedbackConfigs[i]"
            ></codelab-quiz-feedback>
          </label>
        </div>
      </mat-radio-group>
    </ng-container>

    <!-- MULTIPLE‐ANSWER -->
    <ng-template #multipleBlock>
      <div *ngFor="let b of optionBindings; let i = index; trackBy: trackByOption">
        <label class="options">
          <mat-checkbox
            [checked]="b.option.selected"
            (change)="onMatCheckboxChanged(b, i, $event)"
            appHighlightOption
            [optionBinding]="b"
          >
            {{ getOptionDisplayText(b.option, i) }}
          </mat-checkbox>
          <codelab-quiz-feedback
            *ngIf="shouldShowFeedback(i)"
            [feedbackConfig]="feedbackConfigs[i]"
          ></codelab-quiz-feedback>
        </label>
      </div>
    </ng-template>

  </form>
</ng-container>

<ng-template #optionContent let-option="option" let-idx="idx">
  <div class="option-content">
    <span class="option-text" [ngStyle]="optionTextStyle">
      {{ getOptionDisplayText(option, idx) }}
    </span>
    <mat-icon
      *ngIf="shouldShowIcon(option)"
      [ngClass]="optionIconClass"
    >
      {{ getOptionIcon(option) }}
    </mat-icon>
  </div>
</ng-template>

<ng-template #noOptions>
  <p>No options available.</p>
</ng-template>
